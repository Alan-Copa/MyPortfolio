import{p as E,aV as x,aB as I,m as V,g as b,u as C,N as H,r as L,w as M,B as d,D as R,e as T,A as Y,h as k,i as B}from"./index-CjDotdjc.js";import{v as _}from"./index-BJo5YvIL.js";import{V as $}from"./VAvatar-DBnhvCah.js";function z(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;for(;e;){if(t?F(e):w(e))return e;e=e.parentElement}return document.scrollingElement}function G(e,t){const o=[];if(t&&e&&!t.contains(e))return o;for(;e&&(w(e)&&o.push(e),e!==t);)e=e.parentElement;return o}function w(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;const t=window.getComputedStyle(e);return t.overflowY==="scroll"||t.overflowY==="auto"&&e.scrollHeight>e.clientHeight}function F(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;const t=window.getComputedStyle(e);return["scroll","auto"].includes(t.overflowY)}const J=E({closeDelay:[Number,String],openDelay:[Number,String]},"delay");function K(e,t){let o=()=>{};function s(l){o==null||o();const f=Number(l?e.openDelay:e.closeDelay);return new Promise(u=>{o=x(f,()=>{t==null||t(l),u(l)})})}function c(){return s(!0)}function m(){return s(!1)}return{clearDelay:o,runOpenDelay:c,runCloseDelay:m}}function Q(){const t=I("useScopeId").vnode.scopeId;return{scopeId:t?{[t]:""}:void 0}}function O(e){return Math.floor(Math.abs(e))*Math.sign(e)}const q=E({scale:{type:[Number,String],default:.5},...V()},"VParallax"),W=b()({name:"VParallax",props:q(),setup(e,t){let{slots:o}=t;const{intersectionRef:s,isIntersecting:c}=_(),{resizeRef:m,contentRect:l}=C(),{height:f}=H(),u=L();M(()=>{var r;s.value=m.value=(r=u.value)==null?void 0:r.$el});let n;d(c,r=>{r?(n=z(s.value),n=n===document.scrollingElement?document:n,n.addEventListener("scroll",a,{passive:!0}),a()):n.removeEventListener("scroll",a)}),R(()=>{n==null||n.removeEventListener("scroll",a)}),d(f,a),d(()=>{var r;return(r=l.value)==null?void 0:r.height},a);const p=T(()=>1-Y(+e.scale));let g=-1;function a(){c.value&&(cancelAnimationFrame(g),g=requestAnimationFrame(()=>{var y;const r=((y=u.value)==null?void 0:y.$el).querySelector(".v-img__img");if(!r)return;const v=n instanceof Document?document.documentElement.clientHeight:n.clientHeight,h=n instanceof Document?window.scrollY:n.scrollTop,D=s.value.getBoundingClientRect().top+h,i=l.value.height,S=D+(i-v)/2,N=O((h-S)*p.value),P=Math.max(1,(p.value*(v-i)+i)/i);r.style.setProperty("transform",`translateY(${N}px) scale(${P})`)}))}return k(()=>B($,{class:["v-parallax",{"v-parallax--active":c.value},e.class],style:e.style,ref:u,cover:!0,onLoadstart:a,onLoad:a},o)),{}}});export{W as V,K as a,z as b,G as g,w as h,J as m,Q as u};
