import{r as w,C as H,a0 as g,o as S,l as W,n as h,i as n,y as b,z as L,p as P,m as A,b as M,g as p,h as E,c as q,t as $,d as j,M as z,s as F,e as I,O,j as v}from"./index-CMpy-K6U.js";import{B as k}from"./provider-browser-DSVv9z_9.js";import{a as U}from"./axios-DXsv3KKR.js";import{V as G,u as J}from"./VIcon-tQ0Y6iFC.js";import{V as N,m as K,u as Q}from"./VBtn-ltoUdzxy.js";import{V as X}from"./index-DNtFFwS4.js";import{m as Y,a as Z,u as ee,b as te,V as y}from"./index-Bdlz8cTJ.js";import{V as ae}from"./VAvatar-rFOsse6B.js";function oe(){const e=w(null),s=w("0.00"),t=w(null),u=a=>`${a.slice(0,6)}...${a.slice(-4)}`;async function c(){const a=await window.ethereum.request({method:"eth_requestAccounts"});return e.value=a[0],console.log("connected wallet address:",e.value),e.value}const d=async()=>{if(!window.ethereum){alert("metamask is not installed. please install it to use this feature.");return}try{await c();const a=new k(window.ethereum),l=await a.getBalance(e.value);s.value=formatEther(l);const o=await a.getNetwork();t.value=o.name,console.log("initialized ethers.js. network:",o.name,"balance:",s.value),localStorage.setItem("connectedWallet",e.value)}catch(a){console.error("failed to connect wallet:",a)}window.location.reload()},m=()=>{e.value=null,s.value="0.00",t.value=null,localStorage.removeItem("connectedWallet"),window.location.reload()};return H(async()=>{if(!window.ethereum)return;const a=localStorage.getItem("connectedWallet");if(a)try{const l=await window.ethereum.request({method:"eth_accounts"});if(l&&l.length>0&&l.includes(a)){e.value=a;const o=new k(window.ethereum),r=await o.getBalance(e.value);s.value=formatEther(r);const i=await o.getNetwork();t.value=i.name,console.log("restored wallet:",e.value,"network:",i.name,"balance:",s.value)}else localStorage.removeItem("connectedWallet")}catch(l){console.error("failed to restore wallet:",l),localStorage.removeItem("connectedWallet")}}),{getWalletAddress:c,walletAddress:e,walletBalance:s,networkName:t,connectWallet:d,disconnectWallet:m,truncateAddress:u}}const we={__name:"LoginWithMetaMask",setup(e){const{getWalletAddress:s,walletAddress:t,connectWallet:u,disconnectWallet:c,truncateAddress:d}=oe();async function m(){const o=await new k(window.ethereum).getSigner(),r="Login to TrustTheProcess - "+new Date().getTime()+" - confirm to connect your wallet and login",i=await o.signMessage(r);return{message:r,signature:i}}async function a(){const{message:l,signature:o}=await m();try{const r=await s(),i=await U.post("http://localhost:5001/user/login",{walletAddress:r,message:l,signature:o});console.log("message:",l),i.data.success?u():console.error("login failed",i.data.message)}catch(r){console.error("error logging in:",r)}}return(l,o)=>g(t)?(S(),W(N,{key:1,onClick:g(c)},{default:h(()=>[b(" Connected: "+L(g(d)(g(t))),1)]),_:1},8,["onClick"])):(S(),W(N,{key:0,color:"primary",onClick:a},{default:h(()=>[n(G,null,{default:h(()=>o[0]||(o[0]=[b("mdi-wallet")])),_:1}),o[1]||(o[1]=b(" Login with MetaMask "))]),_:1}))}},ne=P({text:String,...A(),...M()},"VToolbarTitle"),le=p()({name:"VToolbarTitle",props:ne(),setup(e,s){let{slots:t}=s;return E(()=>{const u=!!(t.default||t.text||e.text);return n(e.tag,{class:["v-toolbar-title",e.class],style:e.style},{default:()=>{var c;return[u&&n("div",{class:"v-toolbar-title__placeholder"},[t.text?t.text():e.text,(c=t.default)==null?void 0:c.call(t)])]}})}),{}}}),se=[null,"prominent","default","comfortable","compact"],re=P({absolute:Boolean,collapse:Boolean,color:String,density:{type:String,default:"default",validator:e=>se.includes(e)},extended:Boolean,extensionHeight:{type:[Number,String],default:48},flat:Boolean,floating:Boolean,height:{type:[Number,String],default:64},image:String,title:String,...K(),...A(),...Y(),...Z(),...M({tag:"header"}),...q()},"VToolbar"),he=p()({name:"VToolbar",props:re(),setup(e,s){var x;let{slots:t}=s;const{backgroundColorClasses:u,backgroundColorStyles:c}=J($(e,"color")),{borderClasses:d}=Q(e),{elevationClasses:m}=ee(e),{roundedClasses:a}=te(e),{themeClasses:l}=j(e),{rtlClasses:o}=z(),r=F(!!(e.extended||(x=t.extension)!=null&&x.call(t))),i=I(()=>parseInt(Number(e.height)+(e.density==="prominent"?Number(e.height):0)-(e.density==="comfortable"?8:0)-(e.density==="compact"?16:0),10)),f=I(()=>r.value?parseInt(Number(e.extensionHeight)+(e.density==="prominent"?Number(e.extensionHeight):0)-(e.density==="comfortable"?4:0)-(e.density==="compact"?8:0),10):0);return O({VBtn:{variant:"text"}}),E(()=>{var V;const R=!!(e.title||t.title),D=!!(t.image||e.image),T=(V=t.extension)==null?void 0:V.call(t);return r.value=!!(e.extended||T),n(e.tag,{class:["v-toolbar",{"v-toolbar--absolute":e.absolute,"v-toolbar--collapse":e.collapse,"v-toolbar--flat":e.flat,"v-toolbar--floating":e.floating,[`v-toolbar--density-${e.density}`]:!0},u.value,d.value,m.value,a.value,l.value,o.value,e.class],style:[c.value,e.style]},{default:()=>[D&&n("div",{key:"image",class:"v-toolbar__image"},[t.image?n(y,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{cover:!0,src:e.image}}},t.image):n(ae,{key:"image-img",cover:!0,src:e.image},null)]),n(y,{defaults:{VTabs:{height:v(i.value)}}},{default:()=>{var _,C,B;return[n("div",{class:"v-toolbar__content",style:{height:v(i.value)}},[t.prepend&&n("div",{class:"v-toolbar__prepend"},[(_=t.prepend)==null?void 0:_.call(t)]),R&&n(le,{key:"title",text:e.title},{text:t.title}),(C=t.default)==null?void 0:C.call(t),t.append&&n("div",{class:"v-toolbar__append"},[(B=t.append)==null?void 0:B.call(t)])])]}}),n(y,{defaults:{VTabs:{height:v(f.value)}}},{default:()=>[n(X,null,{default:()=>[r.value&&n("div",{class:"v-toolbar__extension",style:{height:v(f.value)}},[T])]})]})]})}),{contentHeight:i,extensionHeight:f}}});export{he as V,we as _,le as a,re as m,oe as u};
